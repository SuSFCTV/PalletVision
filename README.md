# Детекция паллетов с использованием ИИ

![demo gif](md_files/gif_1.gif)

## Описание проекта
Данный проект предназначен для автоматической детекции паллетов на изображениях и классификации их состояния с использованием методов искусственного интеллекта и компьютерного зрения. Система анализирует изображения паллетов и определяет, являются ли они "хорошими" или "плохими", основываясь на различных критериях, таких как структурные повреждения, асимметрия и другие дефекты.

## Для кого предназначен
Этот продукт разработан для складских комплексов, логистических компаний, и предприятий, занимающихся производством и переработкой продукции, где контроль качества паллетов является критически важным. Автоматизация процесса проверки состояния паллетов позволит сократить время и трудозатраты, а также повысить эффективность и точность контроля качества.

## Цель проекта
Цель данного проекта - предоставить инструмент для автоматического распознавания и оценки состояния паллетов. Система может быть интегрирована в существующие процессы складской логистики, обеспечивая более высокий уровень автоматизации и надежности в контроле качества.

## Особенности проекта
- **Высокая точность**: Использование передовых моделей глубокого обучения обеспечивает высокую точность в распознавании дефектов и классификации паллетов.
- **Простота использования**: Интуитивно понятный интерфейс позволяет легко интегрировать и использовать систему даже для тех, кто не имеет опыта работы с системами компьютерного зрения.
- **Автоматизация процесса**: Исключение человеческого фактора из процесса оценки качества паллетов снижает риск ошибок и повышает общую эффективность.
- **Интерактивный интерфейс**: Веб-интерфейс, созданный с использованием Gradio, позволяет пользователям легко загружать изображения и получать результаты в реальном времени.

## Запуск проекта
Для запуска проекта вам потребуется настроить среду с необходимыми библиотеками и запустить скрипт для обработки изображений. Пошаговая инструкция:

1. **Установка зависимостей**:
    ```bash
    pip install -r requirements.txt
    ```

2. **Запуск интерфейса**:
    ```bash
    python demo.py
    ```

3. **Использование веб-интерфейса**:
   - Перейдите в браузер по адресу `http://127.0.0.1:7860` (или другой, указанный в консоли).
   - Загрузите изображение паллета в интерфейс для анализа.
   - Просмотрите результаты анализа, включая изображение с отмеченными областями и текстовое описание обнаруженных объектов.

## Воспроизведение разметки данных:

- **Dockerfile**:
  - Для воспроизведения работы разметки все операции производились внутри контейнера.
  - Разметка производилась на видеокарте A100.

- **Разметка**:
  - В файле `cmds` построчно описано, какие команды нужно прописать в терминале, чтобы собрать образ.
  - Разметка производилась для трёх датасетов (остальные данные для обучения уже имели соответвующую корректную разметку):
    - Для первого датасета достаточно прописать `python3 yolo_world.py`
    - Для второго запустить bash скрипт: `jayaraju_pallets_cwxmr.sh`
    - Для третьего запустить bash скрипт: `dataset_damage_classification.sh`
  

## Как это работает
1. **Предобработка изображения**: Загруженное изображение изменяется в размерах и нормализуется.
2. **Детекция объектов**: Модель ONNX выполняет предсказание, определяя границы (bounding boxes), классы объектов и уровни уверенности для каждого обнаруженного объекта.
3. **Визуализация результатов**: Обнаруженные объекты выделяются на изображении цветными рамками, а текстовое описание накладывается рядом с каждой рамкой.
4. **Классификация состояния**: Система оценивает состояние паллета (например, "Good" или "Bad") на основе обнаруженных объектов и их характеристик.


## Преимущества перед аналогами
- **Быстрая обработка**: Алгоритмы оптимизированы для быстрой обработки большого количества изображений.
- **Адаптивность**: Модель может быть дообучена на данных конкретного предприятия, что обеспечивает более высокую точность в специфических условиях.
- **Поддержка различных сценариев использования**: Возможность настройки критериев оценки качества в зависимости от потребностей конкретного предприятия.
- **Гибкость**: Система может быть настроена на различные критерии оценки качества, что делает ее применимой в различных условиях эксплуатации.

## Используемые материалы и ссылки

## Лицензия
Этот проект распространяется под лицензией MIT. См. файл [LICENSE](LICENSE) для подробностей.

## Контакты
Для получения дополнительной информации или вопросов по использованию системы, пожалуйста, свяжитесь с нами по адресу: https://t.me/SuSPPG




---

### Roadmap: Детекция Паллетов с использованием ИИ

#### 1. **Завершенные этапы:**

- **Сбор и анализ требований к продукту**
  - **Описание**: Определение целей проекта, анализ бизнес-требований, определение критериев успешности.
  - **Статус**: Завершено
  - **Задачи**:
    - Сбор требований от складских и логистических компаний.
    - Определение ключевых функций и показателей эффективности системы.

- **Research моделей**
  - **Описание**: Исследование существующих моделей и подходов к детекции объектов, выбор наиболее подходящего решения.
  - **Статус**: Завершено
  - **Задачи**:
    - Сравнение моделей, таких как YOLO, SSD, Faster R-CNN.
    - Выбор модели, оптимизированной для детекции паллетов.

- **Сбор данных**
  - **Описание**: Сбор и аннотация изображений паллетов для обучения модели.
  - **Статус**: Завершено
  - **Задачи**:
    - Создание датасета изображений паллетов с различными состояниями.
    - Аннотирование изображений для обучения модели.

- **Обучение бейзлайна**
  - **Описание**: Первоначальное обучение модели на собранном датасете для получения базовой производительности.
  - **Статус**: Завершено
  - **Задачи**:
    - Настройка модели и обучение на основном датасете.
    - Оценка базовой точности и выявление областей для улучшения.

- **Генерация данных**
  - **Описание**: Использование моделей, сочетающих анализ визуальной и текстовой информации, для создания дополнительного контекста и разметки данных.
  - **Статус**: Завершено
  - **Задачи**:
    - Применение VLMs для автоматической аннотации данных и расширения информации об объектах.
    - Анализ данных после генерации

- **Дообучение**
  - **Описание**: Дополнительное обучение модели с использованием расширенного набора данных для повышения точности.
  - **Статус**: Завершено
  - **Задачи**:
    - Переподготовка модели с новыми данными.
    - Тонкая настройка гиперпараметров для оптимизации производительности.

- **Деплой и тестирование инференса**
  - **Описание**: Развертывание модели и создание пользовательского интерфейса для взаимодействия с моделью.
  - **Статус**: Завершено
  - **Задачи**:
    - Развертывание модели с использованием ONNX Runtime.
    - Создание веб-интерфейса с помощью Gradio для интерактивного использования.

---

#### 2. **Будущие шаги улучшения и сроки:**

- **Оптимизация модели для реального времени**
  - **Описание**: Уменьшение времени инференса для обеспечения работы в режиме реального времени.
  - **Сроки**: 2 недели
  - **Задачи**:
    - Исследовать и применить методы оптимизации, такие как квантование и обрезка модели.
    - Тестирование производительности на различных аппаратных платформах (CPU, GPU).

- **Интеграция системы оповещения**
  - **Описание**: Разработка системы оповещения для уведомления пользователей о плохом состоянии паллетов.
  - **Сроки**: 3 недели
  - **Задачи**:
    - Создать API для интеграции с существующими системами складского управления.
    - Реализовать оповещения через электронную почту или мессенджеры.

- **Улучшение интерфейса пользователя**
  - **Описание**: Добавление новых функций в веб-интерфейс, таких как загрузка нескольких изображений и создание отчетов.
  - **Сроки**: 4 недели
  - **Задачи**:
    - Разработка функции пакетной обработки изображений.
    - Генерация отчетов об анализе качества паллетов в различных форматах (PDF, Excel).

- **Расширение функционала модели**
  - **Описание**: Расширение классификации на дополнительные категории дефектов и улучшение текущих.
  - **Сроки**: 6 недель
  - **Задачи**:
    - Сбор дополнительных данных для новых классов дефектов.
    - Переподготовка и валидация модели с учетом новых классов.

- **Тестирование в производственных условиях**
  - **Описание**: Проведение полевых испытаний в реальных условиях на складе.
  - **Сроки**: 4 недели
  - **Задачи**:
    - Интеграция системы в производственный процесс.
    - Оценка производительности и точности в реальных условиях эксплуатации.

- **Масштабирование и поддержка**
  - **Описание**: Масштабирование системы для работы с большим количеством данных и внедрение в другие складские процессы.
  - **Сроки**: 8 недель
  - **Задачи**:
    - Оптимизация инфраструктуры для обработки больших объемов данных.
    - Обучение персонала и предоставление технической поддержки.

---


